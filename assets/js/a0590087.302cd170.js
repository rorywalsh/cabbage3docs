"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[1821],{2469:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>r,default:()=>g,frontMatter:()=>i,metadata:()=>o,toc:()=>c});var a=s(4848),t=s(8453);const i={},r="cabbageSendMessage",o={id:"cabbage_opcodes/cabbageSendMessage",title:"cabbageSendMessage",description:"This opcode sends arbitrary JSON data directly to the frontend, allowing you to create custom messages for specialized UI interactions or data visualization. Unlike other Cabbage opcodes that update specific widget properties, cabbageSendMessage gives you complete control over the message format and content.",source:"@site/docs/cabbage_opcodes/cabbageSendMessage.md",sourceDirName:"cabbage_opcodes",slug:"/cabbage_opcodes/cabbageSendMessage",permalink:"/cabbage3docs/docs/cabbage_opcodes/cabbageSendMessage",draft:!1,unlisted:!1,editUrl:"https://github.com/rorywalsh/cabbage3docs/tree/main/docs/cabbage_opcodes/cabbageSendMessage.md",tags:[],version:"current",frontMatter:{},sidebar:"docSidebar",previous:{title:"cabbageSaveState",permalink:"/cabbage3docs/docs/cabbage_opcodes/cabbageSaveState"},next:{title:"cabbageSet",permalink:"/cabbage3docs/docs/cabbage_opcodes/cabbageSet"}},d={},c=[{value:"Syntax",id:"syntax",level:2},{value:"Initialization",id:"initialization",level:3},{value:"Performance",id:"performance",level:3},{value:"Important Notes",id:"important-notes",level:2},{value:"Example:",id:"example",level:2},{value:"Sending Custom Data Arrays",id:"sending-custom-data-arrays",level:3},{value:"Frontend Handling (JavaScript)",id:"frontend-handling-javascript",level:3},{value:"Use Cases",id:"use-cases",level:2}];function l(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"cabbagesendmessage",children:"cabbageSendMessage"})}),"\n",(0,a.jsxs)(n.p,{children:["This opcode sends arbitrary JSON data directly to the frontend, allowing you to create custom messages for specialized UI interactions or data visualization. Unlike other Cabbage opcodes that update specific widget properties, ",(0,a.jsx)(n.code,{children:"cabbageSendMessage"})," gives you complete control over the message format and content."]}),"\n",(0,a.jsxs)(n.p,{children:["\ud83d\udcc3 ",(0,a.jsx)(n.strong,{children:"Note:"})," Every message sent via ",(0,a.jsx)(n.code,{children:"cabbageSendMessage"})," is added to a queue that is passed to the frontend. Calling ",(0,a.jsx)(n.code,{children:"cabbageSendMessage"})," at k-rate can generate a high volume of messages, which may clog the communication channels between Csound and the plugin UI. Therefore, care must be taken to send messages only when absolutely necessary."]}),"\n",(0,a.jsx)(n.p,{children:"The JSON message is sent as-is to the frontend, where it can be handled by custom JavaScript code. This is particularly useful for:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Sending arrays of data for custom visualizations"}),"\n",(0,a.jsx)(n.li,{children:"Triggering custom frontend behaviors"}),"\n",(0,a.jsx)(n.li,{children:"Sending complex data structures that don't map to standard widget properties"}),"\n",(0,a.jsx)(n.li,{children:"Implementing custom communication protocols between Csound and your UI"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"syntax",children:"Syntax"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"cabbageSendMessage:i(SJsonString)\ncabbageSendMessage:k(kTrigger, SJsonString)\n"})}),"\n",(0,a.jsx)(n.h3,{id:"initialization",children:"Initialization"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.em,{children:"SJsonString"})," \u2013 a valid JSON string (object or array) to send to the frontend"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"performance",children:"Performance"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.em,{children:"kTrigger"})," - a signal used to trigger sending the message (sends when trigger == 1)"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.em,{children:"SJsonString"})," \u2013 a valid JSON string (object or array) to send to the frontend"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"important-notes",children:"Important Notes"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"The JSON string must be valid JSON syntax. Invalid JSON will generate a Csound error."}),"\n",(0,a.jsx)(n.li,{children:"Messages are sent through the same queue system as widget updates."}),"\n",(0,a.jsx)(n.li,{children:"The frontend is responsible for handling and interpreting these messages."}),"\n",(0,a.jsx)(n.li,{children:"Messages bypass the channel cache system and are sent directly to the UI queue."}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"example",children:"Example:"}),"\n",(0,a.jsx)(n.h3,{id:"sending-custom-data-arrays",children:"Sending Custom Data Arrays"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-cs",children:'<Cabbage>[\n    {"type":"form","caption":"Custom Message Demo","size":{"width":800,"height":400},"pluginId":"CMsg"}\n]\n</Cabbage>\n<CsoundSynthesizer>\n<CsOptions>\n-dm0 -n\n</CsOptions>\n<CsInstruments>\nksmps = 64\nnchnls = 2\n0dbfs = 1\n\n; Send a message at init time\ninstr 1\n    ; Send a simple status message\n    SJson = sprintf(R{"type":"status","message":"Instrument initialized"}R)\n    cabbageSendMessage(SJson)\nendin\n\n; Send periodic updates at k-rate\ninstr 2\n    trig:k = metro(4)  ; Update 4 times per second\n\n    ; Build JSON message with current values\n    SJson  = sprintf(R{"type":"dataUpdate","value":%d"}R, random:k(0, 100))\n\n    ; Send when triggered\n    cabbageSendMessage kMetro, SJson\nendin\n\n\n</CsInstruments>\n<CsScore>\ni1 0 1      ; Send init message\ni2 0 10     ; Send periodic updates for 10 seconds\n</CsScore>\n</CsoundSynthesizer>\n'})}),"\n",(0,a.jsx)(n.h3,{id:"frontend-handling-javascript",children:"Frontend Handling (JavaScript)"}),"\n",(0,a.jsx)(n.p,{children:"To receive and handle these custom messages in your frontend code:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-javascript",children:'// In your custom widget or frontend code\nCabbage.addMessageListener((message) => {\n    // The message is the JSON object sent from Csound\n    if (message.type === "status") {\n        console.log("Status:", message.message);\n    }\n    else if (message.type === "dataUpdate") {\n        updateVisualization(message.phase, message.value);\n    }\n    else if (message.type === "spectrum") {\n        drawSpectrum(message.data);\n    }\n});\n'})}),"\n",(0,a.jsx)(n.h2,{id:"use-cases",children:"Use Cases"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Real-time Data Visualization"}),": Send arrays of FFT data, waveform samples, or other analysis results for custom visualization."]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"State Synchronization"}),": Broadcast complex state changes that involve multiple related values."]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Event Notifications"}),": Trigger frontend animations, transitions, or other visual effects based on musical events."]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Custom Protocols"}),": Implement domain-specific communication between Csound instruments and specialized UI components."]}),"\n"]}),"\n"]})]})}function g(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>o});var a=s(6540);const t={},i=a.createContext(t);function r(e){const n=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),a.createElement(i.Provider,{value:n},e.children)}}}]);